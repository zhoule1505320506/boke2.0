<!doctype html>

{% extends "base1.html" %}
{% block head %}
    <title>个人技术博客</title>
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1675352_q7ycy0egel.css">
{% endblock head %}



{% block body %}

<style>
.content .zambia1 a {
    height: 35px;
    line-height: 35px;
	background: #3399CC;
	position: relative;
	padding: 0 9px;
	display: inline-block;
	border-radius: 8px;
	color: #FFF;
	text-align: center;
	text-decoration: none;
    top: -4px;
}
.content .zambia a span {

}

.content .zambia a {
    height: 40px;
    line-height: 40px;
	background: #3399CC;
	position: relative;
	padding: 0 7px;
	display: inline-block;
	border-radius: 4px;
	color: #FFF;
	text-align: center;
	text-decoration: none;
    top: -4px;
}


    </style>


  <!--/超小屏幕可见-->
  <div class="content-wrap"><!--内容-->
    <div class="content">
      <header class="news_header">
        <h2>{{ p.title }}</h2>
          &nbsp;
          <span class="zambia1"><a class="a3"  href="javascript:;" name="zambia3" rel="{{ p.id }}"><span class="iconfont icon-shoucang1"></span> 收藏 </a></span>
            &nbsp;
          <span class="zambia1"><a class="a4" href="javascript:;" name="zambia4" rel="{{ p.id }}"><span class="iconfont icon-guanzhu-copy"></span> 关注 </a></span>

        <ul>
            <li> <strong><a href="../his_homepage/{{ p.author_id }}/" style="color: #3399CC">{{ p.author }}</a></strong> 发布于 {{ p.pub_time }}</li>
          <li class="classfy">栏目：<a href="" title="" >{{ p.classfy }}</a></li>
          <li>来源：<a href="" title="" >{{ p.source }}</a></li>
          <li>共 <strong>{{ p.look }}</strong> 人阅读 </li>
{#          <li><strong>123</strong> 个不明物体</li>#}
        </ul>
      </header>
      <article class="news_content">
        {{ p.content|safe }}
      </article>
      <div class="reprint">转载请说明出处：<a href="" title="" >个人技术博客</a> » <a href="" title="" >欢迎来到个人技术博客</a></div>


      <div class="zambia"><a class="a2" href="javascript:;" name="zambia" rel="{{ p.id }}">&nbsp;<span class="iconfont icon-zan1" > </span>点赞（{{ p.zan }}）</a></div>

      <div class="zambia"><a class="a1" href="javascript:;" name="zambia1" rel="{{ p.id }}"><span  style="float: left;margin-top: 2px;margin-left: 3px;" class="iconfont icon-cai" >&nbsp;</span>踩它（{{ p.cai }}）</a></div>


      <div class="tags news_tags">标签：


          <span data-toggle="tooltip" data-placement="bottom" title="查看该标签文章"><a href="../tags/">{{ p.tag }}</a></span>

      </div>

        <nav class="page-nav">
                <span class="page-nav-prev">上一篇<br/>
                        <a href="../content/{{ left.id }}" > {{ left.title }}</a>

                </span>
                <span class="page-nav-next">下一篇<br/>


                        <a href="../content/{{ right.id }}" >{{ right.title }} </a></span>



            </nav>

      <div class="content-block related-content visible-lg visible-md">

        <h2 class="title"><strong>{{ p.author }}的热门推荐</strong></h2>
        <ul>
            {% for i in post %}
          <li><a  href="../content/{{ i.id }}"><img src="/static/media/{{ i.img }}" alt="">
            <h3> {{ i.title|safe }} </h3>
            </a></li>

               {% empty %}
              <dd class="text" >他只有篇文章了，找不到其他的了！</dd>
            {% endfor %}
        </ul>
      </div>
      <div class="content-block comment">
        <h2 class="title"><strong>评论</strong></h2>

            {% csrf_token %}
{#            {#获取文章的id#}
            <input type="hidden" name="commentID" class="form-control" id="commentID" placeholder="技术博客" value="{{ p.id }}">

{#            <div class="comment-title">#}
{##}
{#            <div class="form-group">#}
{#              <label for="commentName" >昵称：</label>#}
{#              <input type="text" name="commentName" class="form-control" id="commentName" placeholder="技术博客">#}
{#            </div>#}
{##}
{#            <div class="form-group">#}
{#              <label for="commentEmail">邮箱：</label>#}
{#              <input type="email" name="commentEmail" class="form-control" id="commentEmail" placeholder="admin@xxxx.com">#}
{#            </div>#}
{##}
{#          </div>#}
          <div class="comment-form">
            <textarea placeholder="你的评论可以一针见血" name="commentContent"></textarea>
            <div class="comment-form-footer">
              <div class="comment-form-text">请先 <a href="/login">登录</a> 或 <a href="register/">注册</a> </div>
              <div class="comment-form-btn">
                <button id="comment_id" type="submit" class="btn btn-default btn-comment" onclick="return false" >提交评论</button>
              </div>
            </div>
          </div>



        <div class="comment-content">

          <ul>
          <li data-toggle="tooltip" data-placement="top" title="站长的评论"><a  href=""><span class="face"><img  src="/static/images/icon/icon8.png" alt=""></span> <span class="text"><strong>技术博客站长</strong> (2015-10-18) 说：<br />
          欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></a></li>

          </ul>
        </div>
      </div>
    </div>
  </div>



<div><a href="javascript:;" class="gotop" style="display:none;"></a></div>
<!--/返回顶部-->
<script src="/static/js/jquery-2.1.4.min.js" type="text/javascript"></script>
<script src="/static/js/nprogress.js" type="text/javascript" ></script>
<script src="/static/js/bootstrap.min.js" type="text/javascript"></script>



<script type="text/javascript">

setTimeout(function() { NProgress.done(); $('.fade').removeClass('out'); }, 1000);
//返回顶部按钮

$(function(){
	$(window).scroll(function(){
		if($(window).scrollTop()>100){
			$(".gotop").fadeIn();
		}
		else{
			$(".gotop").hide();
		}
	});
	$(".gotop").click(function(){
		$('html,body').animate({'scrollTop':0},500);
	});
});

//提示插件启用
$(function () {
  $('[data-toggle="popover"]').popover();
});
$(function () {
	$('[data-toggle="tooltip"]').tooltip();
});

//鼠标滑过显示 滑离隐藏
	//banner
$(function(){
	$(".carousel").hover(function(){
		$(this).find(".carousel-control").show();
	},function(){
		$(this).find(".carousel-control").hide();
	});
});

//本周热门
$(function(){
	$(".hot-content ul li").hover(function(){
		$(this).find("h3").show();
	},function(){
		$(this).find("h3").hide();
	});
});

//相关推荐
$(function(){
	$(".related-content ul li").hover(function(){
		$(this).find("h3").show();
	},function(){
		$(this).find("h3").hide();
	});
});

//页面元素智能定位
$.fn.smartFloat = function() {
	var position = function(element) {
		var top = element.position().top; //当前元素对象element距离浏览器上边缘的距离
		var pos = element.css("position"); //当前元素距离页面document顶部的距离
		$(window).scroll(function() { //侦听滚动时
			var scrolls = $(this).scrollTop();
			if (scrolls > top) { //如果滚动到页面超出了当前元素element的相对页面顶部的高度
				if (window.XMLHttpRequest) { //如果不是ie6
					element.css({ //设置css
						position: "fixed", //固定定位,即不再跟随滚动
						top: 0 //距离页面顶部为0
					}).addClass("shadow"); //加上阴影样式.shadow
				} else { //如果是ie6
					element.css({
						top: scrolls  //与页面顶部距离
					});
				}
			}else {
				element.css({ //如果当前元素element未滚动到浏览器上边缘，则使用默认样式
					position: pos,
					top: top
				}).removeClass("shadow");//移除阴影样式.shadow
			}
		});
	};
	return $(this).each(function() {
		position($(this));
	});
};

//启用页面元素智能定位
$(function(){
	$("#search").smartFloat();
});

//ajax更新点赞值
$(function(){
    $(".content .zambia .a2").click(function(){
        var zambia = $(this);
        var id = zambia.attr("rel"); //对应id
        {#zambia.fadeOut(1000); //渐隐效果   #}
        $.ajax({
            type:"POST",
            url:"/zan",
            data:"id="+id,

            cache:false, //不缓存此页面
            success:function(data){
                {#alert(data);#}
                html = '&nbsp;<span style="color: #333333" class="iconfont icon-zan1"></span> 已赞（' + data + '）</a>';
;                zambia.html(html);
                {#zambia.html(data);#}

                {#zambia.fadeIn(1000); //渐显效果   #}
            }
        });
        return false;
    });
})

//ajax更新踩值
$(function(){
    $(".content .zambia .a1").click(function(){
        var zambia1 = $(this);
        var id = zambia1.attr("rel"); //对应id
        {#zambia1.fadeOut(1000); //渐隐效果   #}
        $.ajax({
            type:"POST",
            url:"/cai",
            data:"id="+id,

            cache:false, //不缓存此页面
            success:function(data){
                {#alert(data);#}
                html = '<span style="float: left;margin-top: 2px;margin-left: 3px;color: #333333" class="iconfont icon-cai">&nbsp;</span> 已踩（' + data + '）</a>';
;                zambia1.html(html);
                {#zambia.html(data);#}

                {#zambia.fadeIn(1000); //渐显效果   #}
            }
        });
        return false;
    });
})

{#评论#}
$(function () {
    $(".btn-comment").click(function () {

                   var commentName = $("#commentName").val();
                   var commentEmail = $("#commentEmail").val();
                   var commentContent = $("textarea[name='commentContent']").val();
                   var commentID = $("#commentID").val();
                   var csrf_value = $("input[name='csrfmiddlewaretoken']").val();



                   if (commentContent) {
                       //获取变量都获取到内容，可以提交
                       form_data = {
                           "commentName": commentName,
                           "commentEmail": commentEmail,
                           "commentContent": commentContent,
                           "commentID": commentID,
                           "csrfmiddlewaretoken": csrf_value
                       };

                     {#console.log(form_data)#}

                       req_comment(form_data)
                   } else {
                       alert("内容不能为空")
                       return false
                   }
               });

               function req_comment(form_data) {

                       $.post('/comment', form_data, function (data) {
                            var cancel = document.getElementById("comment_id")

		                cancel.onclick = function () {
                        if (data[0]=="未")
                        {
                            alert(data)
                        }

                        if (data[0]=="您")
                            {alert(data)}
		}
                           //data 就是所有评论
                           //console.log(data.data)
                           //data 获取到后台传过来的json
                           //data.data 获取到所有的评论内容

                           console.log(data)

                           h_totle = "";

                           data.data.forEach(function (data) {

                               //data 某一条评论的内容
                               h = '<li><span class="face"><img style="width: 60px;height: 60px;margin-top: -13px;margin-left: -10px;" src="/static/images/icon/1 (' + data.random + ').png" alt=""></span> <span ' +
                                   'class="text"><strong>' + data.name + '</strong>\n' +
                                   '(' + data.time + ')\n' + '说：<br/>\n' + data.content + '</span></li>';

                               h_totle += h
                           });
                            {#alert(44444)#}

                           html = '<ul>' + h_totle + '</ul>';

                           $('.comment-content').html(html)

                       })
                   }

                   commentID = $("#commentID").val();


                   form_data = {"commentID": commentID, "csrfmiddlewaretoken": '{{ csrf_token }}'};
                   req_comment(form_data)

})

//ajax更新点收藏
$(function(){
    $(".content .zambia1 .a3").click(function(){
        var zambia = $(this);
        var id = zambia.attr("rel"); //对应id
        {#zambia.fadeOut(1000); //渐隐效果   #}
        $.ajax({
            type:"POST",
            url:"/shoucan",
            data:"id="+id,

            cache:false, //不缓存此页面
            success:function(data){
                {#alert(data);#}
                html = '<span  style="color: #f4ea2a"class="iconfont icon-shoucang"></span> ' + data + '</a>';
;                zambia.html(html);
                {#zambia.html(data);#}

                {#zambia.fadeIn(1000); //渐显效果   #}
            }
        });
        return false;
    });
})

//ajax更新关注
$(function(){
    $(".content .zambia1 .a4").click(function(){
        var zambia = $(this);
        var id = zambia.attr("rel"); //对应id
        {#zambia.fadeOut(1000); //渐隐效果   #}
        $.ajax({
            type:"POST",
            url:"/guanzhu",
            data:"id="+id,

            cache:false, //不缓存此页面
            success:function(data){
                {#alert(data);#}
                html = '<span style="color: #f5db0a" class="iconfont icon-guanzhu"></span> ' + data + '</a>';
;                zambia.html(html);
                {#zambia.html(data);#}

                {#zambia.fadeIn(1000); //渐显效果   #}
            }
        });
        return false;
    });
})

</script>

{% endblock body %}